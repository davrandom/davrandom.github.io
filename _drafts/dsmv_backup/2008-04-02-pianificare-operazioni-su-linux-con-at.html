---
layout: post
title: Pianificare operazioni su linux con AT
date: '2008-04-02T11:23:00.006+02:00'
author: davide scaini
tags:
- Linux
modified_time: '2008-04-06T09:48:55.022+02:00'
blogger_id: tag:blogger.com,1999:blog-23341453.post-6875460396198216383
blogger_orig_url: http://dsmv.blogspot.com/2008/04/pianificare-operazioni-su-linux-con-at.html
---

Quando uno mi dice "dai installami linux, così imparo un po' di linux" non riesco a capire cosa voglia dire... cosa vuoi imparare di linux? non puoi "imparare linux", puoi imparare alcuni aspetti...<br />uno degli aspetti che secondo me sono da conoscere - perché molto potenti e flessibili - è bash script. Chiaramente non possiamo metterci a fare un corso, ma daremo luce ad alcune parti molto utili.<br /><br />Una cosa mooolto utile è AT per poter eseguire scripts a una certa data, ora.<br />Questo minicorso ci è offerto da Matteo Adorisio (sapientemente editato da me ;-) ).<br /><br />Aprite un terminale e digitate:<br /><pre>at ore.minuti gg/mm/aa</pre>        [enter]<br />La sintassi gg/mm/aa che descrive il giorno può essere sostituita anche da tomorrow oppure today.<br /><br />per esempio<br /><pre>elijah@ububook:~$ at 15.00 today<br />warning: commands will be executed using /bin/sh</pre><br />dunque tutto ciò che scriverete d'ora in poi verrà interpretato come codice bash (attenzione non funziona l'autocompletamento); di default possono essere eseguiti solo programmi che non richiedono l'avvio di interfaccia grafica.<br />Altrimenti dovremmo scrivere come prima operazione una cosa del tipo:<br /><pre>at> export DISPLAY=:0 &amp;&amp; vlc /home/elijah/Musica/musica.ogg</pre><br />(at> è già presente sul terminale...)<br />Dopo aver comunicato in sequenza le operazioni da fare si preme CTRL+D e la shell ci dirà:<br /><pre>at> eot </pre><br /><br />Veniamo un po' al dunque.<br />Per gestire i processi ci sono due comandi utili (il resto da sapere: man at):<br /><pre>at -l</pre><br />visualizza i processi in coda e il loro PID, nel nostro esempio:<br /><pre>elijah@ububook:~$ at -l<br />1       Mon Mar 31 15:00:00 2008 a elijah</pre><br />mentre:<br /><pre>atrm PID_PROCESSO</pre><br />rimuove il processo con PID=PID_PROCESSO<br /><br />Un esempio dell'utilizzo che si può fare di at.<br />Mi sono documentato sull'uso di at per poter registrare trasmissioni in streaming e ho trovato molto utile mplayer, un programma dalle potenzialità infinite.<br />Ad esempio simuliamo una situazione:<br />Per registrare lo streaming da un sito rtsp://:<br /><pre>at 7.00 tomorrow<br />warning: commands will be executed using /bin/sh<br />at> mplayer -dumpstrem rtsp://indirizzo_streaming_da_cui_prendere_ciò_che_ci_piace [enter]<br />at> eot</pre><br />Il comando fornisce in output un file stream.dump che può essere ascolatato solo con mplayer.<br />Per renderlo più portabile lo traformiamo in .wav con:<br /><pre>mplayer -ao pcm stream.dump</pre><br />converte stream.dump in audiodump.wav e poi volendo in .mp3 con<br /><pre>lame inputfile outputfile</pre><br />Tutto ciò può essere automatizzato scrivendo degli script bash comunicandoli al sistema attraverso l'opzione:<br /><pre>at -f nomescript.sh ore</pre><br />(-f esegue un file)<br />Uno dei miei scripts per rinominare i files: (aka=rinomino.sh)<br /><pre>#!bin/sh<br />#dichiaro alcune costanti utili<br />artista="M_Knopfler"<br />concerto="kill_to_get_crimson"<br />radio="...."<br />directory_dest="Concerti_Radio2"<br /><br />killall mplayer    #termino la registrazione, si puo' fare in maniera piu' elegante<br />cp /home/matador/stream.dump $artista-$concerto-$radio.stream<br />mv /home/matador/$artista-$concerto-$radio.stream /home/matador/$directory_dest<br /><br />exit<br />#qui finisce il file</pre><br />quindi, avvio la registrazione come spiegato prima e poi alla fine:<br />$at -f rinomino.sh orafineconcerto<br /><br />ecco tutto.<br />spero che sia quasi tutto chiaro.<br />Matteo oisirodA<br /><br /><br />ps: ringrazio Matteo per il suo contributo, ne attendiamo ancora!<br />per ulteriori info <span style="font-weight: bold;">man at</span><br />ciao<br />d